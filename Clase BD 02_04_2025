--creacion y uso de funciones escalares 
--DESARROLLAR UNA FUNCION QUE PERMITA CREAR LOS NOMBRES DE LOS DIAS DE LAS SEMANA 
CREATE FUNCTION FUNCION_NOMBRE_DIAS
(@NUMERO_DIA int)
RETURNS VARCHAR (20)
AS
BEGIN
   DECLARE @NOMBRE_DIA VARCHAR (20)
   SET @NOMBRE_DIA = CASE @NUMERO_DIA
     WHEN 1 THEN 'LUNES'
	 WHEN 2 THEN 'MARTES'
	 WHEN 3 THEN 'MIERCOLES'
	 WHEN 4 THEN 'JUEVES'
	 WHEN 5 THEN 'VIERNES'
	 WHEN 6 THEN'SABADO'
	 WHEN 7 THEN'DOMINGO'
	 ELSE 'DIA NO EXISTE'
  END 
  RETURN @NOMBRE_DIA
END
GO

CREATE FUNCTION FUNCION_NOMBRE_MESES
(@NUMERO_DIA int)
RETURNS VARCHAR (20)
AS
BEGIN
   DECLARE @NOMBRE_DIA VARCHAR (20)
   SET @NOMBRE_DIA = CASE @NUMERO_DIA
     WHEN 1 THEN 'ENERO'
	 WHEN 2 THEN 'FEBRERO'
	 WHEN 3 THEN 'MARZO'
	 WHEN 4 THEN 'ABRIL'
	 WHEN 5 THEN 'MAYO'
	 WHEN 6 THEN'JUNIO'
	 WHEN 7 THEN 'JULIO'
	 WHEN 8 THEN 'AGOSTO'
	 WHEN 9 THEN 'SEPTIEMBRE'
	 WHEN 10 THEN 'OCTUBRE'
	 WHEN 11 THEN 'NOVIEMBRE'
	 WHEN 12 THEN'DICIEMBRE'
	 ELSE 'DIA NO EXISTE'
  END 
  RETURN @NOMBRE_DIA
END
GO

PRINT DBO.FUNCION_NOMBRE_DIAS (5)

SELECT FECHAINICIO,
YEAR (FECHAINICIO),
MONTH (FECHAINICIO),
DAY (FECHAINICIO)
FROM EVALUACION

SELECT FECHAINICIO,
dbo.FUNCION_NOMBRE_MESES (MONTH(FECHAINICIO)) AS 'M',
dbo.FUNCION_NOMBRE_DIAS (DAY(FECHAINICIO)) AS 'D'
FROM EVALUACION

--DESARROLLAR UNA FUNCION ESCALAR QUE PERMITA CLASIFICAR LOS PROVEEDORES DE ACUERDO A 
--PROVEEDORES POR MEJORAR VENTAS <5M, PROVEEDORES REGULAR HASTA 10M, PROVEEDORES BUENOS >10M

ALTER FUNCTION CLASIFICACION_PROVEEDORES
(--PARAMETROS DE ENTRADA
@VENTAS MONEY)
RETURNS VARCHAR (25)--QUE RETORNA
AS
BEGIN
   DECLARE @CLASIFICACION VARCHAR (25) --SE DECLARA EL RESULTADO 

   IF @VENTAS <=5000000
     SET @CLASIFICACION = 'POR MEJORAR'
   ELSE 
     IF @VENTAS <= 10000000
	  SET @CLASIFICACION = 'CLIENTES REGULARES'
   ELSE 
     SET @CLASIFICACION = 'CLIENTES BUENOS'
  
  RETURN @CLASIFICACION
END
GO

PRINT DBO.CLASIFICACION_PROVEEDORES (7500000)

--DESARROLLAR UNA CLASIFICACION IGUAL A LA ANTERIOR CON LA TABLA PERDIDAS 
--PERDIDAS BAJAS <5000, PERDIDAS MEDIAS <10000, PERDIDAS SUPERIORES >10001

ALTER FUNCTION CLASIFICACION_PERDIDAS
(--PARAMETROS DE ENTRADA
@IDPERDIDA NVARCHAR (255))
RETURNS VARCHAR (50)--QUE RETORNA
AS
BEGIN
   DECLARE @CLASIFICACION VARCHAR (50) --SE DECLARA EL RESULTADO 
   DECLARE @PERDIDAS MONEY

   SELECT @PERDIDAS = VALORPERDIDA
   FROM PERDIDAS
   WHERE IDPERDIDA = @IDPERDIDA

   IF @PERDIDAS <=5000000
     SET @CLASIFICACION = 'PERDIDAS BAJAS'
   ELSE 
     IF @PERDIDAS <= 10000000
	   SET @CLASIFICACION = 'PERDIDAS MEDIAS'
   ELSE 
     SET @CLASIFICACION = 'PERDIDAS ALTAS'
  
  RETURN @CLASIFICACION
END
GO

PRINT DBO.CLASIFICACION_PERDIDAS ('AGR-05102014-F2-1')
PRINT DBO.CLASIFICACION_PERDIDAS ('AGR-20001103-F7-20846')
PRINT DBO.CLASIFICACION_PERDIDAS ('AGR-20001116-F7-14252')
